@using MDP.BlazorCore

@attribute [AllowAnonymous]
@page "/Account/Connect"
@code {

    // Fields
    [Inject]
    public IServiceProvider _serviceProvider { get; set; } = null;

    [Inject]
    public NavigationManager _navigationManager { get; set; } = null;

    [Inject]
    public AuthorizationManager _authorizationManager { get; set; } = null;


    // Properties
    public string ErrorMessage { get; set; } = null;


    // Methods
    protected override async Task OnInitializedAsync()
    {
        // ReturnUrl
        var returnUrl = string.Empty;
        if (string.IsNullOrEmpty(returnUrl) == true) returnUrl = _navigationManager.ParseQuery()["returnUrl"];
        if (string.IsNullOrEmpty(returnUrl) == true) returnUrl = "/";

        // LoginAsync
        try
        {
            // Execute
            await _authorizationManager.LoginAsync(_serviceProvider, returnUrl: returnUrl);
        }
        catch (Exception exception)
        {
            // Message
            this.ErrorMessage = exception.Message;
        }
    }
}

<!-- title -->
<h3>Account/Connect</h3>
<hr />

<!-- message -->
<p style="color:red">@ErrorMessage</p>
<br />